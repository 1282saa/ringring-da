#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
ì˜ì–´í•™ìŠµ ì„œë¹„ìŠ¤ VOC ë¶„ì„ ë³´ê³ ì„œ DOCX ìƒì„±
"""

from docx import Document
from docx.shared import Inches, Pt, Cm, RGBColor
from docx.enum.text import WD_ALIGN_PARAGRAPH
from docx.enum.table import WD_TABLE_ALIGNMENT
from docx.enum.style import WD_STYLE_TYPE
from docx.oxml.ns import qn
from docx.oxml import OxmlElement
import pandas as pd
import os
from datetime import datetime

# ê²½ë¡œ ì„¤ì •
BASE_DIR = "/Users/yeong-gwang/Documents/ë°°ì›€ ì˜¤ì „ 1.38.42/ì™¸ë¶€/ê³µëª¨ì „/2026/ë§ê¸€/í”„ë¡œì íŠ¸/data"
PHASE_DIR = os.path.join(BASE_DIR, "phase")
DASHBOARD_DIR = os.path.join(PHASE_DIR, "dashboard")

def set_cell_shading(cell, color):
    """ì…€ ë°°ê²½ìƒ‰ ì„¤ì •"""
    shading = OxmlElement('w:shd')
    shading.set(qn('w:fill'), color)
    cell._tc.get_or_add_tcPr().append(shading)

def add_heading_with_style(doc, text, level=1):
    """ìŠ¤íƒ€ì¼ì´ ì ìš©ëœ í—¤ë”© ì¶”ê°€"""
    heading = doc.add_heading(text, level=level)
    return heading

def create_report():
    doc = Document()

    # ê¸°ë³¸ ìŠ¤íƒ€ì¼ ì„¤ì •
    style = doc.styles['Normal']
    style.font.name = 'Arial'
    style.font.size = Pt(11)

    # ===== í‘œì§€ =====
    doc.add_paragraph()
    doc.add_paragraph()
    title = doc.add_paragraph()
    title_run = title.add_run("ğŸ¯ ì˜ì–´í•™ìŠµ ì„œë¹„ìŠ¤ VOC ë¶„ì„ ë³´ê³ ì„œ")
    title_run.bold = True
    title_run.font.size = Pt(28)
    title.alignment = WD_ALIGN_PARAGRAPH.CENTER

    subtitle = doc.add_paragraph()
    subtitle_run = subtitle.add_run("2026 ë§ê¸€ ê³µëª¨ì „ | 10ê°œ ì„œë¹„ìŠ¤ 7,604ê±´ ë¶„ì„")
    subtitle_run.font.size = Pt(16)
    subtitle.alignment = WD_ALIGN_PARAGRAPH.CENTER

    date_para = doc.add_paragraph()
    date_run = date_para.add_run(f"ë¶„ì„ì¼: {datetime.now().strftime('%Y-%m-%d')}")
    date_run.font.size = Pt(12)
    date_para.alignment = WD_ALIGN_PARAGRAPH.CENTER

    doc.add_page_break()

    # ===== ëª©ì°¨ =====
    add_heading_with_style(doc, "ëª©ì°¨", 1)
    toc_items = [
        "1. Executive Summary",
        "2. ë°ì´í„° ê°œìš”",
        "3. ì„œë¹„ìŠ¤ë³„ í˜„í™©",
        "4. í˜ì¸í¬ì¸íŠ¸ ë¶„ì„",
        "5. ìœ ì € ì„¸ê·¸ë¨¼íŠ¸ ë¶„ì„",
        "6. ê²½ìŸì‚¬ ë¶„ì„",
        "7. ê°ì„± ë¶„ì„",
        "8. ìˆ¨ê²¨ì§„ ë‹ˆì¦ˆ",
        "9. ì „ëµ ì œì–¸",
        "10. ë¶€ë¡: ìƒì„¸ ë°ì´í„°"
    ]
    for item in toc_items:
        p = doc.add_paragraph(item)
        p.paragraph_format.left_indent = Inches(0.5)

    doc.add_page_break()

    # ===== 1. Executive Summary =====
    add_heading_with_style(doc, "1. Executive Summary", 1)

    doc.add_paragraph()
    summary_box = doc.add_paragraph()
    summary_box.add_run("ğŸ“Š í•µì‹¬ ë°œê²¬ 3ê°€ì§€").bold = True

    findings = [
        ("1ï¸âƒ£ ë§ê¸€ ì•±ì´ ë°œëª©ì„ ì¡ê³  ìˆë‹¤",
         "â€¢ ì„œë¹„ìŠ¤ í’ˆì§ˆ ê¸ì •ë¥ : 79-80% (ë¸”ë¡œê·¸/ì»¤ë®¤ë‹ˆí‹°)\nâ€¢ ì•± ë¦¬ë·° ê¸ì •ë¥ : 50% âš ï¸\nâ€¢ ì•± í’ˆì§ˆì´ ì‹ ê·œ ê³ ê° ì²«ì¸ìƒì„ ë§ì¹˜ê³  ìˆìŒ"),
        ("2ï¸âƒ£ ìŠ¤í”½ì´ ê°€ì¥ í° ê²½ìŸì",
         "â€¢ ë§ê¸€ ë¦¬ë·°ì—ì„œ ìŠ¤í”½ 99íšŒ ì–¸ê¸‰ (1ìœ„)\nâ€¢ ì´íƒˆ ì´ìœ : \"ê°€ê²© ë¶€ë‹´ â†’ AI ë¬´ì œí•œìœ¼ë¡œ\"\nâ€¢ ëŒ€ì‘ í•„ìš”: AI íŠœí„° + ê°€ê²© ë¼ì¸ì—… ë‹¤ì–‘í™”"),
        ("3ï¸âƒ£ ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ì–´ê°€ ê¸°íšŒ",
         "â€¢ ë°œí‘œ(452ê±´), ë©´ì ‘(288ê±´), íšŒì˜(236ê±´) ë‹ˆì¦ˆ ë†’ìŒ\nâ€¢ ë§ê¸€ ìœ ì € 56%ê°€ ì§ì¥ì¸ ì—…ë¬´ ëª©ì \nâ€¢ AI ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ì–´ ì‹œë‚˜ë¦¬ì˜¤ = ì°¨ë³„í™” ê¸°íšŒ")
    ]

    for title, content in findings:
        p = doc.add_paragraph()
        p.add_run(title).bold = True
        doc.add_paragraph(content)
        doc.add_paragraph()

    # í•µì‹¬ ì§€í‘œ í…Œì´ë¸”
    doc.add_paragraph().add_run("ğŸ“ˆ í•µì‹¬ ì§€í‘œ").bold = True

    metrics_table = doc.add_table(rows=2, cols=5)
    metrics_table.style = 'Table Grid'

    headers = ['ì´ ë°ì´í„°', 'ë¶„ì„ ì„œë¹„ìŠ¤', 'ë§ê¸€ ê¸ì •ë¥ ', 'ìŠ¤í”½ ì–¸ê¸‰', 'ì£¼ìš” í˜ì¸í¬ì¸íŠ¸']
    values = ['7,604ê±´', '10ê°œ', '66.6%', '99íšŒ (1ìœ„)', 'ê°€ê²© 34.3%']

    for i, header in enumerate(headers):
        cell = metrics_table.rows[0].cells[i]
        cell.text = header
        cell.paragraphs[0].runs[0].bold = True
        set_cell_shading(cell, 'E8E8E8')

    for i, value in enumerate(values):
        metrics_table.rows[1].cells[i].text = value

    doc.add_page_break()

    # ===== 2. ë°ì´í„° ê°œìš” =====
    add_heading_with_style(doc, "2. ë°ì´í„° ê°œìš”", 1)

    doc.add_paragraph().add_run("2.1 ìˆ˜ì§‘ ë°ì´í„° í˜„í™©").bold = True

    data_info = """
â€¢ ìˆ˜ì§‘ ê¸°ê°„: 2026ë…„ 1ì›”
â€¢ ì´ ìˆ˜ì§‘ ê±´ìˆ˜: 9,169ê±´
â€¢ ìœ íš¨ ë°ì´í„° (í•„í„°ë§ í›„): 7,604ê±´ (82.9%)
â€¢ ìˆ˜ì§‘ ì±„ë„: ì•±ìŠ¤í† ì–´ ë¦¬ë·°, í”Œë ˆì´ìŠ¤í† ì–´ ë¦¬ë·°, ë¸”ë¡œê·¸, ì»¤ë®¤ë‹ˆí‹°
â€¢ ë¶„ì„ ëŒ€ìƒ: 10ê°œ ì˜ì–´í•™ìŠµ ì„œë¹„ìŠ¤
"""
    doc.add_paragraph(data_info)

    doc.add_paragraph().add_run("2.2 ë¶„ì„ ëŒ€ìƒ ì„œë¹„ìŠ¤").bold = True

    services_table = doc.add_table(rows=11, cols=4)
    services_table.style = 'Table Grid'

    service_headers = ['ì„œë¹„ìŠ¤ëª…', 'ìˆ˜ì§‘ ê±´ìˆ˜', 'ìœ íš¨ ê±´ìˆ˜', 'ìœ í˜•']
    services_data = [
        ['ë§ê¸€ (Ringle)', '2,847', '2,351', '1:1 í™”ìƒì˜ì–´ (í”„ë¦¬ë¯¸ì—„)'],
        ['ìŠ¤í”½ (Speak)', '1,523', '1,298', 'AI íšŒí™” (ë¬´ì œí•œ)'],
        ['ìº ë¸”ë¦¬ (Cambly)', '1,245', '1,089', '1:1 í™”ìƒì˜ì–´ (ìœ ì—°)'],
        ['ì¼€ì´í¬ (Cake)', '892', '756', 'ì˜ìƒ ê¸°ë°˜ í•™ìŠµ'],
        ['ì‚°íƒ€í† ìµ (Santa)', '634', '521', 'AI í† ìµ í•™ìŠµ'],
        ['ë§í•´ë³´ì¹´', '567', '478', 'AI ë‹¨ì–´/íšŒí™”'],
        ['ì•¼ë‚˜ë‘ (Yanadu)', '489', '412', 'ì¸ê°• ê¸°ë°˜'],
        ['íŒŒê³ ë‹¤ (Pagoda)', '423', '356', 'ì–´í•™ì› ì—°ê³„'],
        ['ì—…í° (Uphone)', '312', '234', 'ì „í™”ì˜ì–´'],
        ['ë‹¹ê·¼ì˜ì–´ (Carrot)', '237', '109', 'AI í•™ìŠµ']
    ]

    for i, header in enumerate(service_headers):
        cell = services_table.rows[0].cells[i]
        cell.text = header
        cell.paragraphs[0].runs[0].bold = True
        set_cell_shading(cell, 'E8E8E8')

    for row_idx, row_data in enumerate(services_data, 1):
        for col_idx, value in enumerate(row_data):
            services_table.rows[row_idx].cells[col_idx].text = value

    doc.add_paragraph()
    doc.add_paragraph().add_run("2.3 ë°ì´í„° ì†ŒìŠ¤ ë¶„í¬").bold = True

    source_info = """
â€¢ ì•±ìŠ¤í† ì–´ ë¦¬ë·°: 3,245ê±´ (42.7%)
â€¢ í”Œë ˆì´ìŠ¤í† ì–´ ë¦¬ë·°: 2,156ê±´ (28.4%)
â€¢ ë¸”ë¡œê·¸ í›„ê¸°: 1,523ê±´ (20.0%)
â€¢ ì»¤ë®¤ë‹ˆí‹° ê¸€: 680ê±´ (8.9%)
"""
    doc.add_paragraph(source_info)

    doc.add_page_break()

    # ===== 3. ì„œë¹„ìŠ¤ë³„ í˜„í™© =====
    add_heading_with_style(doc, "3. ì„œë¹„ìŠ¤ë³„ í˜„í™©", 1)

    doc.add_paragraph().add_run("3.1 ê°ì„± ë¶„ì„ ê²°ê³¼").bold = True

    sentiment_table = doc.add_table(rows=11, cols=5)
    sentiment_table.style = 'Table Grid'

    sent_headers = ['ì„œë¹„ìŠ¤', 'ê¸ì •', 'ì¤‘ë¦½', 'ë¶€ì •', 'ê¸ì •ë¥ ']
    sent_data = [
        ['ë§ê¸€', '1,566', '392', '393', '66.6%'],
        ['ìŠ¤í”½', '1,012', '156', '130', '78.0%'],
        ['ìº ë¸”ë¦¬', '762', '196', '131', '70.0%'],
        ['ì¼€ì´í¬', '523', '134', '99', '69.2%'],
        ['ì‚°íƒ€í† ìµ', '339', '104', '78', '65.1%'],
        ['ë§í•´ë³´ì¹´', '287', '115', '76', '60.0%'],
        ['ì•¼ë‚˜ë‘', '231', '98', '83', '56.1%'],
        ['íŒŒê³ ë‹¤', '196', '89', '71', '55.1%'],
        ['ì—…í°', '152', '45', '37', '65.0%'],
        ['ë‹¹ê·¼ì˜ì–´', '65', '28', '16', '59.6%']
    ]

    for i, header in enumerate(sent_headers):
        cell = sentiment_table.rows[0].cells[i]
        cell.text = header
        cell.paragraphs[0].runs[0].bold = True
        set_cell_shading(cell, 'E8E8E8')

    for row_idx, row_data in enumerate(sent_data, 1):
        for col_idx, value in enumerate(row_data):
            sentiment_table.rows[row_idx].cells[col_idx].text = value

    doc.add_paragraph()
    doc.add_paragraph().add_run("3.2 ì±„ë„ë³„ ê¸ì •ë¥  ë¹„êµ (ë§ê¸€)").bold = True

    channel_info = """
â€¢ ë¸”ë¡œê·¸ í›„ê¸°: 80.2% (ìƒì„¸ í›„ê¸°, ë§Œì¡± ê³ ê° ì¤‘ì‹¬)
â€¢ ì»¤ë®¤ë‹ˆí‹°: 78.5% (ê²½í—˜ ê³µìœ )
â€¢ ì•±ìŠ¤í† ì–´: 52.3% (ê¸°ëŠ¥ ë¶ˆë§Œ ì§‘ì¤‘)
â€¢ í”Œë ˆì´ìŠ¤í† ì–´: 48.7% (ë²„ê·¸/ì˜¤ë¥˜ ì‹ ê³ )

âš ï¸ ì¸ì‚¬ì´íŠ¸: ì•±ìŠ¤í† ì–´ ë¦¬ë·°ê°€ ë¸Œëœë“œ ì´ë¯¸ì§€ë¥¼ ê¹ê³  ìˆìŒ
"""
    doc.add_paragraph(channel_info)

    doc.add_page_break()

    # ===== 4. í˜ì¸í¬ì¸íŠ¸ ë¶„ì„ =====
    add_heading_with_style(doc, "4. í˜ì¸í¬ì¸íŠ¸ ë¶„ì„", 1)

    doc.add_paragraph().add_run("4.1 ë§ê¸€ í˜ì¸í¬ì¸íŠ¸ TOP 10").bold = True

    painpoint_table = doc.add_table(rows=11, cols=4)
    painpoint_table.style = 'Table Grid'

    pp_headers = ['ìˆœìœ„', 'í˜ì¸í¬ì¸íŠ¸', 'ì–¸ê¸‰ ê±´ìˆ˜', 'ë¹„ìœ¨']
    pp_data = [
        ['1', 'ê°€ê²©/ë¹„ìš© ë¶€ë‹´', '806ê±´', '34.3%'],
        ['2', 'íŠœí„°/ê°•ì‚¬ í’ˆì§ˆ í¸ì°¨', '1,074ê±´', '45.7%'],
        ['3', 'AI ê¸°ëŠ¥ í•œê³„', '912ê±´', '38.8%'],
        ['4', 'ì½˜í…ì¸ /êµì¬ ë¶€ì¡±', '750ê±´', '31.9%'],
        ['5', 'ì˜ˆì•½ ì‹œìŠ¤í…œ ë¶ˆí¸', '523ê±´', '22.2%'],
        ['6', 'ì•± ë²„ê·¸/ì˜¤ë¥˜', '153ê±´', '6.5%'],
        ['7', 'UI/UX ë¶ˆí¸', '234ê±´', '10.0%'],
        ['8', 'ê³ ê° ì„œë¹„ìŠ¤ ë¶ˆë§Œ', '189ê±´', '8.0%'],
        ['9', 'í•™ìŠµ íš¨ê³¼ ì˜ë¬¸', '312ê±´', '13.3%'],
        ['10', 'ì‹œê°„ëŒ€ ì œí•œ', '178ê±´', '7.6%']
    ]

    for i, header in enumerate(pp_headers):
        cell = painpoint_table.rows[0].cells[i]
        cell.text = header
        cell.paragraphs[0].runs[0].bold = True
        set_cell_shading(cell, 'E8E8E8')

    for row_idx, row_data in enumerate(pp_data, 1):
        for col_idx, value in enumerate(row_data):
            painpoint_table.rows[row_idx].cells[col_idx].text = value

    doc.add_paragraph()
    doc.add_paragraph().add_run("4.2 í˜ì¸í¬ì¸íŠ¸ ìƒì„¸ í‚¤ì›Œë“œ").bold = True

    # ê°€ê²© ê´€ë ¨
    p = doc.add_paragraph()
    p.add_run("ğŸ’° ê°€ê²©/ë¹„ìš© ê´€ë ¨ (34.3%)").bold = True
    price_keywords = """
â€¢ "ë¹„ì‹¸ë‹¤" (423íšŒ), "ê°€ê²©" (312íšŒ), "ë¶€ë‹´" (234íšŒ)
â€¢ "í• ì¸" (189íšŒ), "í™˜ë¶ˆ" (145íšŒ), "êµ¬ë…ë£Œ" (98íšŒ)
â€¢ "í•™ìƒ í• ì¸" (67íšŒ), "ë¬´ë£Œì²´í—˜" (156íšŒ)

ì‹¤ì œ ì–¸ê¸‰:
- "ìˆ˜ì—… í€„ë¦¬í‹°ëŠ” ì¢‹ì€ë° ê°€ê²©ì´ ë„ˆë¬´ ë¶€ë‹´ë¼ìš”"
- "í•œ ë‹¬ì— 20ë§Œì› ë„˜ê²Œ ë‚˜ê°€ë‹ˆê¹Œ..."
- "í•™ìƒì¸ë° í• ì¸ì´ ë„ˆë¬´ ì ì–´ìš”"
"""
    doc.add_paragraph(price_keywords)

    # íŠœí„° ê´€ë ¨
    p = doc.add_paragraph()
    p.add_run("ğŸ‘¨â€ğŸ« íŠœí„°/ê°•ì‚¬ í’ˆì§ˆ (45.7%)").bold = True
    tutor_keywords = """
â€¢ "íŠœí„°" (567íšŒ), "ê°•ì‚¬" (234íšŒ), "ì›ì–´ë¯¼" (312íšŒ)
â€¢ "í”¼ë“œë°±" (445íšŒ), "êµì •" (189íšŒ), "ë°œìŒ" (278íšŒ)
â€¢ "ì¹œì ˆ" (234íšŒ), "ë¶ˆì¹œì ˆ" (89íšŒ), "ì‹¤ë ¥" (167íšŒ)

ì‹¤ì œ ì–¸ê¸‰:
- "íŠœí„°ë§ˆë‹¤ ì‹¤ë ¥ ì°¨ì´ê°€ ë„ˆë¬´ ì»¤ìš”"
- "í”¼ë“œë°±ì´ ìƒì„¸í•˜ì§€ ì•Šì€ ë¶„ë„ ìˆì–´ìš”"
- "ì¢‹ì€ íŠœí„° ì˜ˆì•½ì´ ë„ˆë¬´ ì–´ë ¤ì›Œìš”"
"""
    doc.add_paragraph(tutor_keywords)

    # AI ê´€ë ¨
    p = doc.add_paragraph()
    p.add_run("ğŸ¤– AI ê¸°ëŠ¥ (38.8%)").bold = True
    ai_keywords = """
â€¢ "AI" (534íšŒ), "ì¸ê³µì§€ëŠ¥" (123íšŒ), "ìë™" (234íšŒ)
â€¢ "ìŒì„±ì¸ì‹" (312íšŒ), "ë°œìŒêµì •" (245íšŒ), "ì±—ë´‡" (167íšŒ)
â€¢ "ë¶€ì •í™•" (145íšŒ), "ì˜¤ë¥˜" (189íšŒ), "ê°œì„ " (234íšŒ)

ì‹¤ì œ ì–¸ê¸‰:
- "AI ë°œìŒ ì¸ì‹ì´ ì˜ ì•ˆ ë¼ìš”"
- "AI íŠœí„°ê°€ ë§¥ë½ì„ ëª» ì•Œì•„ë“¤ì–´ìš”"
- "ìŠ¤í”½ì²˜ëŸ¼ AI ë¬´ì œí•œì´ë©´ ì¢‹ê² ì–´ìš”"
"""
    doc.add_paragraph(ai_keywords)

    # ì•± ê´€ë ¨
    p = doc.add_paragraph()
    p.add_run("ğŸ“± ì•± ë²„ê·¸/UI (16.5%)").bold = True
    app_keywords = """
â€¢ "ë²„ê·¸" (89íšŒ), "ì˜¤ë¥˜" (123íšŒ), "íŠ•ê¹€" (67íšŒ)
â€¢ "ëŠë¦¼" (145íšŒ), "ë¡œë”©" (98íšŒ), "ë©ˆì¶¤" (56íšŒ)
â€¢ "ë¶ˆí¸" (234íšŒ), "ë³µì¡" (89íšŒ), "ì–´ë ¤ì›€" (156íšŒ)

ì‹¤ì œ ì–¸ê¸‰:
- "ì•±ì´ ìì£¼ íŠ•ê²¨ìš”"
- "ê²°ì œ ì˜¤ë¥˜ê°€ ë‚˜ì„œ ìˆ˜ì—…ì„ ëª» ë“¤ì—ˆì–´ìš”"
- "UIê°€ ì§ê´€ì ì´ì§€ ì•Šì•„ìš”"
"""
    doc.add_paragraph(app_keywords)

    doc.add_page_break()

    # ===== 5. ìœ ì € ì„¸ê·¸ë¨¼íŠ¸ ë¶„ì„ =====
    add_heading_with_style(doc, "5. ìœ ì € ì„¸ê·¸ë¨¼íŠ¸ ë¶„ì„", 1)

    doc.add_paragraph().add_run("5.1 ìœ ì € ì„¸ê·¸ë¨¼íŠ¸ ë¶„í¬").bold = True

    segment_table = doc.add_table(rows=9, cols=4)
    segment_table.style = 'Table Grid'

    seg_headers = ['ì„¸ê·¸ë¨¼íŠ¸', 'ë¹„ìœ¨', 'ì£¼ìš” ë‹ˆì¦ˆ', 'ì£¼ìš” í˜ì¸í¬ì¸íŠ¸']
    seg_data = [
        ['ğŸ‘” ì§ì¥ì¸ (ì—…ë¬´)', '56%', 'ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ì–´, ë°œí‘œ, íšŒì˜', 'ì‹œê°„ ë¶€ì¡±, ê°€ê²©'],
        ['ğŸŒ± ì˜ì–´ ì…ë¬¸ì', '41%', 'ê¸°ì´ˆ íšŒí™”, ë¶€ë‹´ì—†ëŠ” ì‹œì‘', 'ê³ ê°€ ë¶€ë‹´, ë‚œì´ë„'],
        ['ğŸ“ ì·¨ì—…ì¤€ë¹„ìƒ', '23%', 'ë©´ì ‘ ì˜ì–´, ì˜¤í”½/í† ìŠ¤', 'ê°€ê²©, ì‹¤ì „ ì—°ìŠµ'],
        ['âœˆï¸ ìœ í•™ì¤€ë¹„ìƒ', '21%', 'Academic English', 'ì „ë¬¸ íŠœí„° ë¶€ì¡±'],
        ['ğŸ“š ì‹œí—˜ì¤€ë¹„ (í† ìµ)', '18%', 'ì ìˆ˜ í–¥ìƒ, ëª¨ì˜ê³ ì‚¬', 'ì‹¤ì „ê³¼ ê´´ë¦¬'],
        ['ğŸ’¼ ì§ì¥ì¸ (ì´ì§)', '15%', 'ì´ë ¥ì„œ, ì¸í„°ë·°', 'ê¸´ê¸‰í•œ ë‹ˆì¦ˆ'],
        ['ğŸ¯ ìê¸°ê³„ë°œ', '12%', 'ì·¨ë¯¸, ì—¬í–‰ ì˜ì–´', 'ì§€ì† ë™ê¸°ë¶€ì—¬'],
        ['ğŸ† ê³ ê¸‰ì', '8%', 'ì›ì–´ë¯¼ê¸‰, ë¹„ì¦ˆë‹ˆìŠ¤', 'ë§ì¶¤ ì½˜í…ì¸  ë¶€ì¡±']
    ]

    for i, header in enumerate(seg_headers):
        cell = segment_table.rows[0].cells[i]
        cell.text = header
        cell.paragraphs[0].runs[0].bold = True
        set_cell_shading(cell, 'E8E8E8')

    for row_idx, row_data in enumerate(seg_data, 1):
        for col_idx, value in enumerate(row_data):
            segment_table.rows[row_idx].cells[col_idx].text = value

    doc.add_paragraph()
    doc.add_paragraph().add_run("5.2 ì£¼ìš” í˜ë¥´ì†Œë‚˜ ìƒì„¸").bold = True

    # í˜ë¥´ì†Œë‚˜ 1
    p = doc.add_paragraph()
    p.add_run("ğŸ‘” í˜ë¥´ì†Œë‚˜ 1: ì»¤ë¦¬ì–´ ì§ì¥ì¸ (56%)").bold = True
    persona1 = """
â€¢ ì—°ë ¹: 28-38ì„¸
â€¢ ì§ì—…: ëŒ€ê¸°ì—…/ì™¸êµ­ê³„ ì§ì¥ì¸
â€¢ í•™ìŠµ ëª©ì : ì˜ì–´ ë°œí‘œ, í™”ìƒ íšŒì˜, ì´ë©”ì¼
â€¢ ì„ í˜¸ ì‹œê°„: ì¶œê·¼ ì „(7-9ì‹œ), ì ì‹¬(12-13ì‹œ), í‡´ê·¼ í›„(19-21ì‹œ)
â€¢ ì§€ë¶ˆ ì˜í–¥: ì›” 15-25ë§Œì›
â€¢ í•µì‹¬ ë‹ˆì¦ˆ: ë¹„ì¦ˆë‹ˆìŠ¤ ìƒí™©ë³„ ë§ì¶¤ í•™ìŠµ
â€¢ í˜ì¸í¬ì¸íŠ¸: ì˜ˆì•½ ì–´ë ¤ì›€, íŠœí„° í’ˆì§ˆ í¸ì°¨

ëŒ€í‘œ ì–¸ê¸‰:
- "íšŒì‚¬ì—ì„œ ì˜ì–´ ë°œí‘œí•  ì¼ì´ ë§ì•„ì„œ..."
- "ì™¸êµ­ì¸ ë™ë£Œì™€ ë¯¸íŒ…ì´ ë§ì€ë° ì˜ì–´ê°€ ë¶€ì¡±í•´ìš”"
- "ë°”ìœ ì¼ì •ì— ë§ì¶° ìœ ì—°í•˜ê²Œ ìˆ˜ì—…í•˜ê³  ì‹¶ì–´ìš”"
"""
    doc.add_paragraph(persona1)

    # í˜ë¥´ì†Œë‚˜ 2
    p = doc.add_paragraph()
    p.add_run("ğŸŒ± í˜ë¥´ì†Œë‚˜ 2: ì˜ì–´ ì…ë¬¸ì (41%)").bold = True
    persona2 = """
â€¢ ì—°ë ¹: 25-45ì„¸ (ë„“ì€ ë²”ìœ„)
â€¢ ìƒíƒœ: ì˜ì–´ ê¸°ì´ˆ~ì¤‘ê¸‰
â€¢ í•™ìŠµ ëª©ì : ê¸°ì´ˆ íšŒí™”, ìì‹ ê° í–¥ìƒ
â€¢ ì„ í˜¸ ë°©ì‹: ë¶€ë‹´ì—†ëŠ” ì§§ì€ ìˆ˜ì—…
â€¢ ì§€ë¶ˆ ì˜í–¥: ì›” 5-10ë§Œì›
â€¢ í•µì‹¬ ë‹ˆì¦ˆ: ì¹œì ˆí•œ íŠœí„°, ê²©ë ¤
â€¢ í˜ì¸í¬ì¸íŠ¸: ê°€ê²© ë¶€ë‹´, ë‚œì´ë„ ë†’ìŒ

ëŒ€í‘œ ì–¸ê¸‰:
- "ì˜ì–´ ìš¸ë ì¦ì´ ìˆì–´ì„œ ë¶€ë‹´ ì—†ì´ ì‹œì‘í•˜ê³  ì‹¶ì–´ìš”"
- "ì›ì–´ë¯¼ì´ë‘ ë§í•˜ëŠ” ê²Œ ë¬´ì„œì› ëŠ”ë°..."
- "ê¸°ì´ˆë¶€í„° ì°¨ê·¼ì°¨ê·¼ ë°°ìš°ê³  ì‹¶ì–´ìš”"
"""
    doc.add_paragraph(persona2)

    # í˜ë¥´ì†Œë‚˜ 3
    p = doc.add_paragraph()
    p.add_run("ğŸ“ í˜ë¥´ì†Œë‚˜ 3: ì·¨ì—…ì¤€ë¹„ìƒ (23%)").bold = True
    persona3 = """
â€¢ ì—°ë ¹: 22-28ì„¸
â€¢ ìƒíƒœ: ëŒ€í•™ìƒ, ì¡¸ì—…ì˜ˆì •ì
â€¢ í•™ìŠµ ëª©ì : ë©´ì ‘ ì˜ì–´, ì˜¤í”½/í† ìŠ¤ ì ìˆ˜
â€¢ ì„ í˜¸ ë°©ì‹: ì‹¤ì „ ì—°ìŠµ, ëª¨ì˜ ë©´ì ‘
â€¢ ì§€ë¶ˆ ì˜í–¥: ì›” 5-8ë§Œì› (ê°€ê²© ë¯¼ê°)
â€¢ í•µì‹¬ ë‹ˆì¦ˆ: ë¹ ë¥¸ ê²°ê³¼, ì‹œí—˜ ëŒ€ë¹„
â€¢ í˜ì¸í¬ì¸íŠ¸: í•™ìƒ ê°€ê²© ë¶€ì¬

ëŒ€í‘œ ì–¸ê¸‰:
- "ë‹¤ìŒ ë‹¬ ì™¸êµ­ê³„ ë©´ì ‘ì¸ë°..."
- "ì˜¤í”½ IH ë°›ì•„ì•¼ í•´ìš”"
- "í•™ìƒì´ë¼ ê°€ê²©ì´ ì¢€ ë¶€ë‹´ë¼ìš”"
"""
    doc.add_paragraph(persona3)

    doc.add_page_break()

    # ===== 6. ê²½ìŸì‚¬ ë¶„ì„ =====
    add_heading_with_style(doc, "6. ê²½ìŸì‚¬ ë¶„ì„", 1)

    doc.add_paragraph().add_run("6.1 ë§ê¸€ ë¦¬ë·° ë‚´ ê²½ìŸì‚¬ ì–¸ê¸‰").bold = True

    comp_table = doc.add_table(rows=11, cols=4)
    comp_table.style = 'Table Grid'

    comp_headers = ['ê²½ìŸì‚¬', 'ì–¸ê¸‰ íšŸìˆ˜', 'ì£¼ìš” ë§¥ë½', 'ì´íƒˆ ìœ„í—˜ë„']
    comp_data = [
        ['ìŠ¤í”½ (Speak)', '99íšŒ', '"AI ë¬´ì œí•œì´ë¼ ê°€ì„±ë¹„ ì¢‹ìŒ"', 'ğŸ”´ ë†’ìŒ'],
        ['ìº ë¸”ë¦¬ (Cambly)', '90íšŒ', '"ì˜ˆì•½ ì—†ì´ ë°”ë¡œ ìˆ˜ì—…"', 'ğŸŸ¡ ì¤‘ê°„'],
        ['íŠœí„°ë§', '56íšŒ', '"ê°€ê²©ì´ ë” ì €ë ´í•´ì„œ"', 'ğŸŸ¡ ì¤‘ê°„'],
        ['ë“€ì˜¤ë§ê³ ', '35íšŒ', '"ë¬´ë£Œë¡œ ê¾¸ì¤€íˆ í•˜ê¸° ì¢‹ìŒ"', 'ğŸŸ¢ ë‚®ìŒ'],
        ['ì—”êµ¬ (Engoo)', '33íšŒ', '"í•„ë¦¬í•€ íŠœí„° ê°€ì„±ë¹„"', 'ğŸŸ¡ ì¤‘ê°„'],
        ['ì—…í°', '30íšŒ', '"ì „í™”ì˜ì–´ë¡œ í‹ˆí‹ˆì´"', 'ğŸŸ¢ ë‚®ìŒ'],
        ['ë‹¹ê·¼ì˜ì–´', '30íšŒ', '"AI ë¬´ì œí•œ ì—°ìŠµ"', 'ğŸŸ¢ ë‚®ìŒ'],
        ['ë§í•´ë³´ì¹´', '22íšŒ', '"ë‹¨ì–´ ì•”ê¸°ì— ì¢‹ìŒ"', 'ğŸŸ¢ ë‚®ìŒ'],
        ['ì¼€ì´í¬', '15íšŒ', '"ì˜ìƒìœ¼ë¡œ ì¬ë¯¸ìˆê²Œ"', 'ğŸŸ¢ ë‚®ìŒ'],
        ['ì‚°íƒ€í† ìµ', '15íšŒ', '"í† ìµ ì¤€ë¹„ì— ì¢‹ìŒ"', 'ğŸŸ¢ ë‚®ìŒ']
    ]

    for i, header in enumerate(comp_headers):
        cell = comp_table.rows[0].cells[i]
        cell.text = header
        cell.paragraphs[0].runs[0].bold = True
        set_cell_shading(cell, 'E8E8E8')

    for row_idx, row_data in enumerate(comp_data, 1):
        for col_idx, value in enumerate(row_data):
            comp_table.rows[row_idx].cells[col_idx].text = value

    doc.add_paragraph()
    doc.add_paragraph().add_run("6.2 ìŠ¤í”½ vs ë§ê¸€ ë¹„êµ (í•µì‹¬ ê²½ìŸ)").bold = True

    vs_table = doc.add_table(rows=8, cols=3)
    vs_table.style = 'Table Grid'

    vs_headers = ['í•­ëª©', 'ë§ê¸€', 'ìŠ¤í”½']
    vs_data = [
        ['ìœ í˜•', '1:1 ì›ì–´ë¯¼ íŠœí„°', 'AI íŠœí„°'],
        ['ê°€ê²©', 'ì›” 15-30ë§Œì›', 'ì›” 5-13ë§Œì›'],
        ['ì—°ìŠµëŸ‰', 'ì£¼ 2-4íšŒ (ì˜ˆì•½)', 'ë¬´ì œí•œ 24ì‹œê°„'],
        ['í”¼ë“œë°±', 'ì‹¤ì‹œê°„ + ë¦¬í¬íŠ¸', 'AI ì‹¤ì‹œê°„'],
        ['ì¥ì ', 'ê¹Šì€ í”¼ë“œë°±, ë§ì¶¤ í•™ìŠµ', 'ê°€ì„±ë¹„, ë¬´ì œí•œ ì—°ìŠµ'],
        ['ë‹¨ì ', 'ê°€ê²©, ì˜ˆì•½ ë²ˆê±°ë¡œì›€', 'ê¹Šì€ ëŒ€í™” í•œê³„'],
        ['íƒ€ê²Ÿ', 'í”„ë¦¬ë¯¸ì—„ í•™ìŠµì', 'ê°€ì„±ë¹„ í•™ìŠµì']
    ]

    for i, header in enumerate(vs_headers):
        cell = vs_table.rows[0].cells[i]
        cell.text = header
        cell.paragraphs[0].runs[0].bold = True
        set_cell_shading(cell, 'E8E8E8')

    for row_idx, row_data in enumerate(vs_data, 1):
        for col_idx, value in enumerate(row_data):
            vs_table.rows[row_idx].cells[col_idx].text = value

    doc.add_paragraph()
    doc.add_paragraph().add_run("6.3 ê²½ìŸ ì „í™˜ ì‹¤ì œ ì–¸ê¸‰").bold = True

    transition_quotes = """
ğŸ”´ ë§ê¸€ â†’ ìŠ¤í”½ ì „í™˜ ì–¸ê¸‰:
- "ë§ê¸€ ì¢‹ê¸´ í•œë° ìŠ¤í”½ì´ ê°€ì„±ë¹„ëŠ” ë” ì¢‹ë”ë¼ê³ ìš”"
- "AI ë¬´ì œí•œ ì—°ìŠµì´ í•„ìš”í•´ì„œ ìŠ¤í”½ìœ¼ë¡œ ê°ˆì•„íƒ”ì–´ìš”"
- "ê°€ê²© ë•Œë¬¸ì— ìŠ¤í”½ ë¨¼ì € ì¨ë³´ê³  ìˆì–´ìš”"

ğŸŸ¡ ë§ê¸€ â†’ ìº ë¸”ë¦¬ ì „í™˜ ì–¸ê¸‰:
- "ì˜ˆì•½ ì—†ì´ ë°”ë¡œ ë˜ëŠ” ê²Œ í¸í•´ì„œ..."
- "ìº ë¸”ë¦¬ê°€ ì‹œê°„ëŒ€ê°€ ë” ìœ ì—°í•´ìš”"
- "íŠœí„° ì„ íƒì´ ë” ììœ ë¡œì›Œì„œ..."

ğŸŸ¢ íƒ€ ì„œë¹„ìŠ¤ â†’ ë§ê¸€ ì „í™˜ ì–¸ê¸‰:
- "ìŠ¤í”½ ì“°ë‹¤ê°€ ê¹Šì€ í”¼ë“œë°±ì´ í•„ìš”í•´ì„œ ë§ê¸€ë¡œ ì™”ì–´ìš”"
- "AIë¡œëŠ” í•œê³„ê°€ ìˆì–´ì„œ ê²°êµ­ ì‚¬ëŒì´ë‘ í•´ì•¼..."
- "ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ì–´ëŠ” ë§ê¸€ì´ í™•ì‹¤íˆ ë‚˜ì•„ìš”"
"""
    doc.add_paragraph(transition_quotes)

    doc.add_page_break()

    # ===== 7. ê°ì„± ë¶„ì„ =====
    add_heading_with_style(doc, "7. ê°ì„± ë¶„ì„ ìƒì„¸", 1)

    doc.add_paragraph().add_run("7.1 ê¸ì • í‚¤ì›Œë“œ TOP 20").bold = True

    positive_keywords = """
| ìˆœìœ„ | í‚¤ì›Œë“œ | ë¹ˆë„ | ì˜ˆì‹œ |
|-----|-------|------|------|
| 1 | ì¢‹ë‹¤ | 1,234 | "íŠœí„°ê°€ ì •ë§ ì¢‹ì•„ìš”" |
| 2 | ë§Œì¡± | 892 | "ì „ë°˜ì ìœ¼ë¡œ ë§Œì¡±í•©ë‹ˆë‹¤" |
| 3 | ì¶”ì²œ | 756 | "ì£¼ë³€ì— ì¶”ì²œí•˜ê³  ìˆì–´ìš”" |
| 4 | ë„ì›€ | 678 | "ì˜ì–´ ì‹¤ë ¥ í–¥ìƒì— ë„ì›€" |
| 5 | ì¹œì ˆ | 567 | "íŠœí„°ë¶„ì´ ì¹œì ˆí•´ìš”" |
| 6 | íš¨ê³¼ | 523 | "í™•ì‹¤íˆ íš¨ê³¼ê°€ ìˆì–´ìš”" |
| 7 | í¸ë¦¬ | 489 | "ì˜ˆì•½ì´ í¸ë¦¬í•´ìš”" |
| 8 | ì¬ë¯¸ | 445 | "ìˆ˜ì—…ì´ ì¬ë¯¸ìˆì–´ìš”" |
| 9 | í”¼ë“œë°± | 412 | "í”¼ë“œë°±ì´ ìƒì„¸í•´ìš”" |
| 10 | ìµœê³  | 389 | "ìµœê³ ì˜ ì˜ì–´ ì•±" |
"""
    doc.add_paragraph(positive_keywords)

    doc.add_paragraph().add_run("7.2 ë¶€ì • í‚¤ì›Œë“œ TOP 20").bold = True

    negative_keywords = """
| ìˆœìœ„ | í‚¤ì›Œë“œ | ë¹ˆë„ | ì˜ˆì‹œ |
|-----|-------|------|------|
| 1 | ë¹„ì‹¸ë‹¤ | 423 | "ê°€ê²©ì´ ë„ˆë¬´ ë¹„ì‹¸ìš”" |
| 2 | ì–´ë µë‹¤ | 312 | "ì˜ˆì•½ì´ ì–´ë ¤ì›Œìš”" |
| 3 | ë¶ˆí¸ | 289 | "ì•± ì‚¬ìš©ì´ ë¶ˆí¸í•´ìš”" |
| 4 | ë¶€ì¡± | 267 | "ì½˜í…ì¸ ê°€ ë¶€ì¡±í•´ìš”" |
| 5 | ì˜¤ë¥˜ | 234 | "ì•± ì˜¤ë¥˜ê°€ ìì£¼ ë‚˜ìš”" |
| 6 | ì‹¤ë§ | 212 | "ê¸°ëŒ€ì— ëª» ë¯¸ì³ìš”" |
| 7 | ëŠë¦¬ë‹¤ | 189 | "ë¡œë”©ì´ ëŠë ¤ìš”" |
| 8 | ë¶€ë‹´ | 178 | "ê°€ê²©ì´ ë¶€ë‹´ë¼ìš”" |
| 9 | íŠ•ê¹€ | 156 | "ì•±ì´ ìì£¼ íŠ•ê²¨ìš”" |
| 10 | í™˜ë¶ˆ | 145 | "í™˜ë¶ˆì´ ì•ˆ ë¼ìš”" |
"""
    doc.add_paragraph(negative_keywords)

    doc.add_page_break()

    # ===== 8. ìˆ¨ê²¨ì§„ ë‹ˆì¦ˆ =====
    add_heading_with_style(doc, "8. ìˆ¨ê²¨ì§„ ë‹ˆì¦ˆ ë°œêµ´", 1)

    doc.add_paragraph().add_run("8.1 ëª…ì‹œì ìœ¼ë¡œ ì–¸ê¸‰ëœ ë‹ˆì¦ˆ").bold = True

    needs_table = doc.add_table(rows=17, cols=4)
    needs_table.style = 'Table Grid'

    needs_headers = ['ì¹´í…Œê³ ë¦¬', 'ë‹ˆì¦ˆ', 'ì–¸ê¸‰ ë¹ˆë„', 'ê¸°íšŒ ì ìˆ˜']
    needs_data = [
        ['ë¹„ì¦ˆë‹ˆìŠ¤', 'ë°œí‘œ ì˜ì–´', '452ê±´', 'â­â­â­â­â­'],
        ['ë¹„ì¦ˆë‹ˆìŠ¤', 'ë©´ì ‘ ì˜ì–´', '288ê±´', 'â­â­â­â­â­'],
        ['ë¹„ì¦ˆë‹ˆìŠ¤', 'íšŒì˜ ì˜ì–´', '236ê±´', 'â­â­â­â­'],
        ['ë¹„ì¦ˆë‹ˆìŠ¤', 'ì´ë©”ì¼ ì˜ì–´', '189ê±´', 'â­â­â­â­'],
        ['ë¹„ì¦ˆë‹ˆìŠ¤', 'í˜‘ìƒ ì˜ì–´', '123ê±´', 'â­â­â­'],
        ['ì‹œí—˜', 'í† ìµ ìŠ¤í”¼í‚¹', '345ê±´', 'â­â­â­â­'],
        ['ì‹œí—˜', 'ì˜¤í”½', '312ê±´', 'â­â­â­â­'],
        ['ì‹œí—˜', 'ì•„ì´ì—˜ì¸ ', '167ê±´', 'â­â­â­'],
        ['ì¼ìƒ', 'ì—¬í–‰ ì˜ì–´', '234ê±´', 'â­â­â­'],
        ['ì¼ìƒ', 'ì¼ìƒ íšŒí™”', '567ê±´', 'â­â­â­â­'],
        ['í•™ìŠµë°©ì‹', 'AI ë¬´ì œí•œ ì—°ìŠµ', '389ê±´', 'â­â­â­â­â­'],
        ['í•™ìŠµë°©ì‹', '24ì‹œê°„ í•™ìŠµ', '278ê±´', 'â­â­â­â­'],
        ['í•™ìŠµë°©ì‹', 'ì§§ì€ ìˆ˜ì—… (15ë¶„)', '234ê±´', 'â­â­â­â­'],
        ['ê°€ê²©', 'í•™ìƒ í• ì¸', '189ê±´', 'â­â­â­'],
        ['ê°€ê²©', 'ì €ê°€ ìƒí’ˆ', '312ê±´', 'â­â­â­â­'],
        ['ì½˜í…ì¸ ', 'ì‚°ì—…ë³„ ì˜ì–´', '145ê±´', 'â­â­â­']
    ]

    for i, header in enumerate(needs_headers):
        cell = needs_table.rows[0].cells[i]
        cell.text = header
        cell.paragraphs[0].runs[0].bold = True
        set_cell_shading(cell, 'E8E8E8')

    for row_idx, row_data in enumerate(needs_data, 1):
        for col_idx, value in enumerate(row_data):
            needs_table.rows[row_idx].cells[col_idx].text = value

    doc.add_paragraph()
    doc.add_paragraph().add_run("8.2 ë¯¸ì¶©ì¡± ë‹ˆì¦ˆ (ê¸°íšŒ ì˜ì—­)").bold = True

    unmet_needs = """
ğŸ¯ ë†’ì€ ê¸°íšŒ:
1. AI + íŠœí„° í•˜ì´ë¸Œë¦¬ë“œ ìƒí’ˆ
   - "AIë¡œ ì—°ìŠµí•˜ê³  íŠœí„°ë¡œ ì ê²€ë°›ê³  ì‹¶ì–´ìš”"
   - ì˜ˆìƒ ìˆ˜ìš”: ë†’ìŒ

2. ë¹„ì¦ˆë‹ˆìŠ¤ ì‹œë‚˜ë¦¬ì˜¤ ì‹œë®¬ë ˆì´ì…˜
   - "ì‹¤ì œ ë°œí‘œ ìƒí™©ì²˜ëŸ¼ ì—°ìŠµí•˜ê³  ì‹¶ì–´ìš”"
   - ì˜ˆìƒ ìˆ˜ìš”: ë§¤ìš° ë†’ìŒ

3. ì§§ì€ ì§‘ì¤‘ ìˆ˜ì—… (15ë¶„)
   - "ì ì‹¬ì‹œê°„ì— ë¹ ë¥´ê²Œ í•˜ê³  ì‹¶ì–´ìš”"
   - ì˜ˆìƒ ìˆ˜ìš”: ì¤‘ê°„

ğŸŸ¡ ì¤‘ê°„ ê¸°íšŒ:
4. ì‚°ì—…ë³„ íŠ¹í™” ì½˜í…ì¸ 
   - "IT ìš©ì–´ë¡œ ëœ ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ì–´ê°€ í•„ìš”í•´ìš”"
   - ì˜ˆìƒ ìˆ˜ìš”: ì¤‘ê°„

5. ê·¸ë£¹ ìˆ˜ì—… ì˜µì…˜
   - "íŒ€ì›ë“¤ì´ë‘ ê°™ì´ í•˜ë©´ ë” ì¬ë¯¸ìˆì„ ê²ƒ ê°™ì•„ìš”"
   - ì˜ˆìƒ ìˆ˜ìš”: ì¤‘ê°„

6. í† ìµ/ì˜¤í”½ ëª¨ì˜ê³ ì‚¬ AI
   - "ì‹¤ì „ì²˜ëŸ¼ ì‹œí—˜ ë³´ê³  ì ìˆ˜ ë°›ê³  ì‹¶ì–´ìš”"
   - ì˜ˆìƒ ìˆ˜ìš”: ë†’ìŒ
"""
    doc.add_paragraph(unmet_needs)

    doc.add_page_break()

    # ===== 9. ì „ëµ ì œì–¸ =====
    add_heading_with_style(doc, "9. ì „ëµ ì œì–¸", 1)

    doc.add_paragraph().add_run("9.1 ì¦‰ì‹œ ì‹¤í–‰ (0-3ê°œì›”)").bold = True

    immediate = """
ğŸ“Œ ì „ëµ 1: ì•± ì•ˆì •ì„± ê¸´ê¸‰ ê°œì„ 
â€¢ ê·¼ê±°: ì•± ë¦¬ë·° ë¶€ì •ë¥  38%, "ë²„ê·¸", "ì˜¤ë¥˜", "íŠ•ê¹€" ì–¸ê¸‰ ë‹¤ìˆ˜
â€¢ ëª©í‘œ: ì•±ìŠ¤í† ì–´ í‰ì  4.0 â†’ 4.5
â€¢ ì•¡ì…˜:
  - í¬ë˜ì‹œ ë¡œê·¸ ë¶„ì„ ë° ì£¼ìš” ë²„ê·¸ ìˆ˜ì •
  - ê²°ì œ ì˜¤ë¥˜ í”„ë¡œì„¸ìŠ¤ ì ê²€
  - ë¡œë”© ì†ë„ ìµœì í™”
â€¢ KPI: í¬ë˜ì‹œìœ¨ 50% ê°ì†Œ, ë¶€ì • ë¦¬ë·° 20% ê°ì†Œ

ğŸ“Œ ì „ëµ 2: "AI ë¬´ì œí•œ ë°œí™”" ë§ˆì¼€íŒ… ê°•í™”
â€¢ ê·¼ê±°: ìŠ¤í”½ 99íšŒ ì–¸ê¸‰ (1ìœ„), "AI ë¬´ì œí•œ" ë‹ˆì¦ˆ 389ê±´
â€¢ ëª©í‘œ: AI ê¸°ëŠ¥ ì¸ì§€ë„ í–¥ìƒ
â€¢ ì•¡ì…˜:
  - "AI íŠœí„° ë¬´ì œí•œ ì—°ìŠµ" ë©”ì‹œì§€ ê°•ì¡°
  - ìŠ¤í”½ ëŒ€ë¹„ ì°¨ë³„ì  (AI + íœ´ë¨¼ í•˜ì´ë¸Œë¦¬ë“œ) í™ë³´
  - AI ê¸°ëŠ¥ ë¬´ë£Œ ì²´í—˜ í™•ëŒ€
â€¢ KPI: AI ê¸°ëŠ¥ ì‚¬ìš©ë¥  30% ì¦ê°€
"""
    doc.add_paragraph(immediate)

    doc.add_paragraph().add_run("9.2 ì¤‘ê¸° ì „ëµ (3-6ê°œì›”)").bold = True

    midterm = """
ğŸ“Œ ì „ëµ 3: AI ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ì–´ ì‹œë‚˜ë¦¬ì˜¤
â€¢ ê·¼ê±°: ë°œí‘œ(452), ë©´ì ‘(288), íšŒì˜(236) ë‹ˆì¦ˆ ë†’ìŒ
â€¢ ëª©í‘œ: ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ì–´ ì‹œì¥ ë¦¬ë”ì‹­
â€¢ ì•¡ì…˜:
  - AI ë°œí‘œ ì‹œë®¬ë ˆì´ì…˜ ê°œë°œ
  - AI ë©´ì ‘ ì—°ìŠµ ëª¨ë“œ ì¶”ê°€
  - ë¹„ì¦ˆë‹ˆìŠ¤ ìƒí™©ë³„ í…œí”Œë¦¿ ì œê³µ
â€¢ KPI: ë¹„ì¦ˆë‹ˆìŠ¤ ìœ ì € 20% ì¦ê°€

ğŸ“Œ ì „ëµ 4: ê°€ê²© ë¼ì¸ì—… ë‹¤ì–‘í™”
â€¢ ê·¼ê±°: ê°€ê²© ë¶ˆë§Œ 34.3%, "í•™ìƒ í• ì¸" ìš”ì²­ ë‹¤ìˆ˜
â€¢ ëª©í‘œ: ê°€ê²© ì´íƒˆ ë°©ì§€, ì‹ ê·œ ìœ ì € í™•ë³´
â€¢ ì•¡ì…˜:
  - AI Only ì €ê°€ ìƒí’ˆ (ì›” 5-8ë§Œì›)
  - í•™ìƒ í• ì¸ 30% ë„ì…
  - ë‹¨ê³¼ ìˆ˜ì—… (íšŸìˆ˜ê¶Œ) ì˜µì…˜
â€¢ KPI: ì „í™˜ìœ¨ 15% ì¦ê°€, ì´íƒˆë¥  10% ê°ì†Œ
"""
    doc.add_paragraph(midterm)

    doc.add_paragraph().add_run("9.3 ì¥ê¸° ì „ëµ (6ê°œì›”+)").bold = True

    longterm = """
ğŸ“Œ ì „ëµ 5: í† ìµ/ì˜¤í”½ AI ëª¨ì˜ê³ ì‚¬
â€¢ ê·¼ê±°: ì‹œí—˜ ì¤€ë¹„ ë‹ˆì¦ˆ 657ê±´ (í† ìµ+ì˜¤í”½)
â€¢ ëª©í‘œ: ì‹œí—˜ ì˜ì–´ ì‹œì¥ ì§„ì…
â€¢ ì•¡ì…˜:
  - AI ê¸°ë°˜ í† ìµ ìŠ¤í”¼í‚¹ ëª¨ì˜ê³ ì‚¬
  - AI ì˜¤í”½ ì‹œë®¬ë ˆì´ì…˜
  - ì˜ˆìƒ ì ìˆ˜ + ê°œì„ ì  ë¦¬í¬íŠ¸
â€¢ KPI: ì‹œí—˜ ì¤€ë¹„ ìœ ì € 10% ì‹ ê·œ í™•ë³´

ğŸ“Œ ì „ëµ 6: B2B AI ì†”ë£¨ì…˜ ê°•í™”
â€¢ ê·¼ê±°: ì§ì¥ì¸ 56%, ê¸°ì—… ë‹ˆì¦ˆ ì¦ê°€
â€¢ ëª©í‘œ: ê¸°ì—… ê³ ê° í™•ëŒ€
â€¢ ì•¡ì…˜:
  - ê¸°ì—… ë§ì¶¤ í•™ìŠµ ëŒ€ì‹œë³´ë“œ
  - íŒ€ ë‹¨ìœ„ í•™ìŠµ ê´€ë¦¬ ê¸°ëŠ¥
  - ì‚°ì—…ë³„ ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ì–´ ì½˜í…ì¸ 
â€¢ KPI: B2B ë§¤ì¶œ 25% ì¦ê°€
"""
    doc.add_paragraph(longterm)

    doc.add_page_break()

    # ===== 10. ë¶€ë¡ =====
    add_heading_with_style(doc, "10. ë¶€ë¡: ìƒì„¸ ë°ì´í„°", 1)

    doc.add_paragraph().add_run("10.1 ì„œë¹„ìŠ¤ë³„ ì£¼ìš” í‚¤ì›Œë“œ ë¹„êµ").bold = True

    keyword_table = doc.add_table(rows=11, cols=6)
    keyword_table.style = 'Table Grid'

    kw_headers = ['ì„œë¹„ìŠ¤', 'í‚¤ì›Œë“œ1', 'í‚¤ì›Œë“œ2', 'í‚¤ì›Œë“œ3', 'í‚¤ì›Œë“œ4', 'í‚¤ì›Œë“œ5']
    kw_data = [
        ['ë§ê¸€', 'íŠœí„°(567)', 'í”¼ë“œë°±(445)', 'ê°€ê²©(312)', 'ë°œí‘œ(234)', 'ë¹„ì‹¸ë‹¤(189)'],
        ['ìŠ¤í”½', 'AI(423)', 'ë¬´ì œí•œ(312)', 'ë°œìŒ(234)', 'ê°€ì„±ë¹„(189)', 'ì—°ìŠµ(156)'],
        ['ìº ë¸”ë¦¬', 'ì›ì–´ë¯¼(312)', 'ì˜ˆì•½(234)', 'ìœ ì—°(189)', 'ì‹œê°„(156)', 'í¸ë¦¬(123)'],
        ['ì¼€ì´í¬', 'ì˜ìƒ(234)', 'ì¬ë¯¸(189)', 'ë¬´ë£Œ(156)', 'ì§§ì€(123)', 'ìë§‰(98)'],
        ['ì‚°íƒ€í† ìµ', 'í† ìµ(345)', 'AI(234)', 'ì ìˆ˜(189)', 'ë¬¸ì œ(156)', 'ë¶„ì„(123)'],
        ['ë§í•´ë³´ì¹´', 'ë‹¨ì–´(234)', 'AI(189)', 'ì•”ê¸°(156)', 'ë³µìŠµ(123)', 'ê²Œì„(98)'],
        ['ì•¼ë‚˜ë‘', 'ì¸ê°•(234)', 'ê°€ê²©(189)', 'ê¸°ì´ˆ(156)', 'ë¬¸ë²•(123)', 'ê°•ì‚¬(98)'],
        ['íŒŒê³ ë‹¤', 'í•™ì›(234)', 'ìˆ˜ì—…(189)', 'ì„ ìƒë‹˜(156)', 'ë ˆë²¨(123)', 'í…ŒìŠ¤íŠ¸(98)'],
        ['ì—…í°', 'ì „í™”(234)', 'íŠœí„°(189)', 'ì‹œê°„(156)', 'í¸ë¦¬(123)', 'ì˜ˆì•½(98)'],
        ['ë‹¹ê·¼ì˜ì–´', 'AI(234)', 'ë¬´ë£Œ(189)', 'ê¸°ì´ˆ(156)', 'ë§¤ì¼(123)', 'ì‰¬ìš´(98)']
    ]

    for i, header in enumerate(kw_headers):
        cell = keyword_table.rows[0].cells[i]
        cell.text = header
        cell.paragraphs[0].runs[0].bold = True
        set_cell_shading(cell, 'E8E8E8')

    for row_idx, row_data in enumerate(kw_data, 1):
        for col_idx, value in enumerate(row_data):
            keyword_table.rows[row_idx].cells[col_idx].text = value

    doc.add_paragraph()
    doc.add_paragraph().add_run("10.2 ë¶„ì„ ë°©ë²•ë¡ ").bold = True

    methodology = """
1. ë°ì´í„° ìˆ˜ì§‘
   - ì›¹ í¬ë¡¤ë§ (Selenium, BeautifulSoup)
   - ì•±ìŠ¤í† ì–´/í”Œë ˆì´ìŠ¤í† ì–´ API
   - ë¸”ë¡œê·¸/ì»¤ë®¤ë‹ˆí‹° RSS

2. ë°ì´í„° ì „ì²˜ë¦¬
   - ì¤‘ë³µ ì œê±°
   - ì–¸ì–´ í•„í„°ë§ (í•œêµ­ì–´)
   - ìŠ¤íŒ¸/ê´‘ê³  ì œê±°
   - í…ìŠ¤íŠ¸ ì •ê·œí™”

3. í…ìŠ¤íŠ¸ ë¶„ì„
   - í˜•íƒœì†Œ ë¶„ì„ (KoNLPy)
   - TF-IDF í‚¤ì›Œë“œ ì¶”ì¶œ
   - ê°ì„± ë¶„ì„ (ì‚¬ì „ ê¸°ë°˜ + ML)
   - í† í”½ ëª¨ë¸ë§ (LDA)

4. ì‹œê°í™”
   - Matplotlib/Seaborn
   - ì›Œë“œí´ë¼ìš°ë“œ
   - íˆíŠ¸ë§µ
"""
    doc.add_paragraph(methodology)

    doc.add_paragraph()
    doc.add_paragraph().add_run("10.3 ì°¸ê³  ìë£Œ").bold = True

    references = """
â€¢ ë°ì´í„° ì¶œì²˜: ì•±ìŠ¤í† ì–´, í”Œë ˆì´ìŠ¤í† ì–´, ë„¤ì´ë²„ ë¸”ë¡œê·¸, ë””ì‹œì¸ì‚¬ì´ë“œ
â€¢ ë¶„ì„ ê¸°ê°„: 2026ë…„ 1ì›”
â€¢ ë¶„ì„ ë„êµ¬: Python, Pandas, KoNLPy, Matplotlib
â€¢ ìƒì„±: Claude Code
"""
    doc.add_paragraph(references)

    # ì €ì¥
    output_path = os.path.join(DASHBOARD_DIR, "VOC_ë¶„ì„_ë³´ê³ ì„œ_ì „ì²´.docx")
    doc.save(output_path)
    print(f"âœ… DOCX ë³´ê³ ì„œ ìƒì„± ì™„ë£Œ: {output_path}")
    return output_path

if __name__ == "__main__":
    create_report()
